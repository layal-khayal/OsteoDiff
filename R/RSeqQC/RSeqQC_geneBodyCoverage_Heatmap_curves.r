accepted_hits.2 <- c(0.0,0.036184331379,0.0815383351955,0.140687909129,0.204992317185,0.276394414777,0.344880068119,0.411158127684,0.47212737265,0.530751792117,0.574849639416,0.618877790288,0.669011131978,0.703765335915,0.743747852378,0.764192677661,0.793894160844,0.816744323253,0.836849310924,0.853595363081,0.875312553353,0.889033564502,0.902315866364,0.922993553351,0.934389189166,0.937135444469,0.943804149801,0.947071777594,0.949435512977,0.96470335256,0.968519907244,0.973162553677,0.970483293388,0.979066759451,0.981106865692,0.98988051115,0.987159108837,0.994072562084,0.993849425464,0.996772353103,0.996745879266,0.998928079772,0.998607692324,1.0,0.998091182376,0.997410966868,0.99613427962,0.989697355426,0.985381039547,0.978926286034,0.975774818951,0.969159601574,0.962240205221,0.94930422436,0.949416603093,0.930018845049,0.92371969286,0.907707344166,0.894079801868,0.893393643254,0.887023714074,0.882658232499,0.872337218324,0.860125756125,0.845360919431,0.83289390367,0.822059080958,0.817412652549,0.808905906583,0.799428813475,0.791422909269,0.779186594082,0.764238601663,0.752756520668,0.745759323653,0.73702565909,0.730133817138,0.716983884457,0.709312415041,0.69993257276,0.688061488456,0.673860166277,0.660248292167,0.642170443961,0.625131018475,0.598964062578,0.571236230904,0.546633392476,0.521686394177,0.494713877261,0.462907994234,0.424781347724,0.388071321596,0.350192664694,0.300822741998,0.248335930291,0.18532117626,0.122025475394,0.057563845168,0.0126982566168)
accepted_hits <- c(0.0,0.0452556901605,0.0972890103388,0.162732947911,0.228364546841,0.304286347543,0.374882555786,0.439549039155,0.497634282301,0.559323745771,0.601625484038,0.643801906914,0.693219190338,0.722400843416,0.761031027717,0.780408154104,0.808910236148,0.830651521584,0.848716888837,0.86303962772,0.884127527428,0.896905956721,0.909381384617,0.929258525655,0.941863009702,0.942468389036,0.946110016939,0.948961097987,0.95035078958,0.963753925458,0.966286418617,0.970754754036,0.97152909094,0.98031176724,0.981809317355,0.990636259292,0.987017699396,0.994339609702,0.996069710272,0.998352819565,0.997716267247,0.999648992209,0.999784906416,1.0,0.997271740506,0.996854022531,0.994459313957,0.987548263571,0.98580195305,0.980406533109,0.977350957291,0.969374414338,0.961435902424,0.947999099724,0.94564429257,0.927746635968,0.919563727865,0.902815730885,0.890255512474,0.889583422956,0.883752204709,0.880173546232,0.869176964662,0.855532549894,0.840695456787,0.827938848582,0.815763928245,0.811429013194,0.802526009179,0.795537026334,0.785740604619,0.772365524426,0.755528372714,0.743397718013,0.735421175059,0.724804280425,0.718570930694,0.704523137523,0.695676244877,0.686316244927,0.675122026643,0.66087347946,0.647245898103,0.629903744062,0.612557849264,0.586033381277,0.556621048123,0.531561710349,0.506342143442,0.478603799488,0.446680794263,0.407992004753,0.370709740248,0.331741640809,0.282226474217,0.230318469431,0.168417653136,0.107832336733,0.0448223856933,0.00119953639539)
accepted_hits.1 <- c(0.0,0.0425176092771,0.0937197261083,0.156582793591,0.221250106101,0.295495630739,0.3658576793,0.43196305647,0.491223947354,0.547312678048,0.589699107769,0.631887715911,0.680809974136,0.714685165556,0.754126719452,0.772126378525,0.802334855811,0.82375219831,0.842704487533,0.857903778743,0.880932455155,0.894308560974,0.907361277619,0.925466160936,0.937150260921,0.939059730191,0.9440789266,0.949148630647,0.950543904114,0.965224790551,0.969595104126,0.973790043963,0.974119746592,0.983044165421,0.985490979827,0.993358947252,0.989716083946,0.995126714541,0.994221084553,0.997887097193,0.996707884172,0.999225549569,0.998103859134,0.999631013653,0.999216430134,1.0,0.996354330714,0.989072813072,0.986469565291,0.982448596203,0.978216477134,0.970308524497,0.963100663825,0.948802092139,0.94885470426,0.930377327122,0.922436404221,0.907224486102,0.89366248412,0.890994698803,0.886298891568,0.880448423636,0.868777652054,0.855465382276,0.841072810266,0.828873111488,0.818519045939,0.812743637967,0.804216265283,0.795124890654,0.787161519915,0.773302785566,0.757695224292,0.746483931907,0.739925655565,0.729124737729,0.721567532569,0.707042378012,0.698120765163,0.688773344875,0.677484888045,0.662455358615,0.649077148311,0.631740401971,0.614512387349,0.588120744118,0.560548484876,0.535080710502,0.509295158913,0.479903221756,0.448846637068,0.409960667178,0.37247067225,0.333613463652,0.283885889219,0.231423887447,0.169679002923,0.109721527547,0.0473958052005,0.00398098387474)
accepted_hits.8 <- c(0.0,0.0372386264572,0.0910642783455,0.156016056472,0.222359661985,0.287761560885,0.3579424335,0.428339623867,0.479504017865,0.531606121842,0.568730344685,0.603727359699,0.653161211679,0.686878305028,0.72742864137,0.753430235027,0.786217611662,0.810986244089,0.829199399506,0.850258157502,0.863181769359,0.876967155172,0.889173871014,0.910053280112,0.920110307066,0.919604233433,0.930427614735,0.937617557208,0.940809867686,0.954264532132,0.959630011715,0.96694185149,0.971903171578,0.975001561185,0.979025171293,0.989201098075,0.985027114656,0.989348473911,0.994718949285,0.99888394028,0.995612196724,1.0,0.995733094868,0.995672146217,0.993621373992,0.998644641889,0.999643300519,0.993942603357,0.992325465795,0.987874715552,0.985720030874,0.982676594969,0.978652485281,0.96711470586,0.969064063526,0.951041247749,0.9453330569,0.935322490801,0.919123138756,0.918382262943,0.911825786775,0.911231787219,0.903069663808,0.894868573227,0.879548979984,0.866849679145,0.856206146322,0.854691422477,0.845696001119,0.834421499886,0.826509166028,0.813793878657,0.800276766824,0.787806273215,0.780930565998,0.767329524875,0.758102298813,0.740623025101,0.727142382543,0.710989990933,0.697736157287,0.680703507295,0.662064210902,0.637771677362,0.615209186261,0.587897696191,0.556977746249,0.530782815478,0.504920104812,0.476081900998,0.443619250781,0.406586450915,0.364283091495,0.322129605807,0.271769534167,0.219758853166,0.160102613548,0.104179728579,0.0480909833465,0.00832598535734)
accepted_hits.5 <- c(0.0,0.0379518040452,0.0921697575287,0.158162171748,0.224938532159,0.292263361291,0.361688696435,0.42881386886,0.484120538627,0.538760120099,0.577289754146,0.610177324518,0.659402685853,0.692987293025,0.733254527656,0.758299699986,0.790573032368,0.812864116581,0.831681174075,0.852205296423,0.868415072202,0.881428578979,0.892541236451,0.910266641533,0.921056912145,0.921851428397,0.930296319916,0.936843885484,0.938526286861,0.952555693945,0.955379661911,0.962769896231,0.966646759718,0.971151367384,0.975086366207,0.986648838497,0.981972173727,0.987064007004,0.992825277479,0.996025069836,0.992882825589,0.996826632795,0.993060167723,0.993627427664,0.991747131256,0.996941729015,1.0,0.994104254861,0.991882780372,0.988502122527,0.986556644076,0.984603531692,0.98148477647,0.969123677348,0.970399718601,0.952055377724,0.94716378838,0.937114009265,0.920540740832,0.922322970563,0.914317323801,0.913846956087,0.905165999872,0.894882504964,0.881972349895,0.869289451138,0.860523347209,0.859017113516,0.85029622596,0.83846069376,0.831304175233,0.818873783489,0.804742786374,0.793237862193,0.78680480562,0.773165316341,0.763073256982,0.746751321111,0.735926991414,0.72128745692,0.708941038438,0.691684826619,0.673247704095,0.6487650939,0.626822234476,0.600029478726,0.571284785043,0.545726964754,0.519619501293,0.490272314133,0.45744111742,0.418253790688,0.374214218729,0.333901767725,0.283683407882,0.232537231572,0.171914995569,0.113387393323,0.0540318029647,0.0116012291806)
accepted_hits.11 <- c(0.0,0.0405107992093,0.0954548448941,0.162729372301,0.229072970697,0.299084506331,0.36699279636,0.43229198473,0.487496171218,0.544408824015,0.583548234,0.619137034578,0.666517762904,0.698243881282,0.736129710724,0.76105033412,0.795601937448,0.815425532171,0.836494052104,0.854512048462,0.869527606421,0.882519740167,0.890881752301,0.912120493758,0.92162308627,0.923868183145,0.933241907385,0.938074948441,0.940866773768,0.956476183653,0.957850938839,0.964481884631,0.966802956084,0.969943879791,0.97371327675,0.982987945527,0.981235721708,0.986896789497,0.992634312716,0.995722823581,0.994252859746,0.997895792691,0.995196771754,0.99749139636,0.995124163138,1.0,0.998803640817,0.992698266,0.991539894107,0.985802851739,0.985215250887,0.98142181134,0.977342745846,0.964027479716,0.962533473293,0.943647539506,0.938208144379,0.925684360248,0.90846602037,0.910107167432,0.901987504586,0.900997911661,0.892733993286,0.886651218502,0.871772222444,0.860987679135,0.854267775767,0.850649366261,0.843165389444,0.832198603318,0.825045933365,0.810315039649,0.7963121555,0.784108618643,0.775737951177,0.761312879182,0.750515833727,0.736218187449,0.724079084728,0.712015475733,0.698429490062,0.682787863109,0.666848108065,0.64501214872,0.623070401987,0.595984503109,0.566810745883,0.543866904079,0.520693215134,0.493325056272,0.461793202006,0.422184961553,0.37770136509,0.334408357588,0.281338191218,0.22904363874,0.166053500529,0.10662070365,0.0475057497849,0.00651890733169)
accepted_hits.10 <- c(0.0,0.0368517536939,0.0883355307715,0.151817369427,0.215163854456,0.283131134446,0.35135874787,0.417625215689,0.473603819936,0.530847535996,0.571075226483,0.606843657176,0.654100350388,0.688432748266,0.727128571619,0.751756509694,0.78606568998,0.807740053855,0.829228676987,0.847016317028,0.862154681531,0.876613807947,0.886572179297,0.906755183328,0.916648841813,0.918744353062,0.929815192901,0.934286802478,0.937993219475,0.953728819504,0.955623276279,0.961139183541,0.963598766405,0.966881832826,0.971140038146,0.981100385461,0.979571482275,0.985590272718,0.990533644021,0.994316135684,0.992289783222,0.996660618566,0.994376402627,0.997104716777,0.995311528226,1.0,0.997930176301,0.99215245363,0.990617128557,0.984876949228,0.984564252712,0.980433003166,0.977206745748,0.963251984487,0.963542451392,0.945677254712,0.939427770316,0.926989562457,0.910191387063,0.912254788876,0.904910619678,0.902750889555,0.893307751169,0.88538660009,0.870696285729,0.86018019816,0.852271396864,0.849254097782,0.84093281372,0.829662401381,0.823044399447,0.808311601831,0.794614210056,0.782477830904,0.77503535743,0.76139922058,0.752309779991,0.737266755816,0.725979547771,0.712881367487,0.701080902443,0.684647786647,0.667813549886,0.645666930293,0.625208279097,0.599175923653,0.568458554374,0.544770681812,0.520917322152,0.491620671957,0.459209406385,0.41898961976,0.375969396249,0.332736262471,0.280855316359,0.228651299914,0.167695732952,0.109976303236,0.0523275142801,0.011625098119)
accepted_hits.4 <- c(0.0,0.0326678922381,0.08133719868,0.141669374889,0.203957938216,0.268500927802,0.338096570071,0.404274732802,0.460409030424,0.520675993729,0.560169143949,0.594222675659,0.644911426325,0.678354328116,0.722187100672,0.747093579439,0.779819678236,0.803864915512,0.82491736555,0.845018569509,0.863929233759,0.877164758516,0.889171478139,0.907390131078,0.916532872424,0.916702641554,0.926817109063,0.933818064621,0.936566168731,0.951625499,0.954862430415,0.962262208691,0.96424608224,0.967854349943,0.970373400465,0.981580318853,0.979270919734,0.984221171989,0.989393471488,0.992730108582,0.989343349173,0.992330207964,0.989496949815,0.99107553325,0.991043196273,0.995909372388,1.0,0.993723931681,0.992190620013,0.989011895157,0.987953937054,0.984570411343,0.981573312508,0.968192271355,0.969053512847,0.950296449238,0.946692493132,0.937373515261,0.920851475725,0.921668523348,0.914836797971,0.913923817315,0.90563099952,0.896180517941,0.883183747866,0.868407905097,0.858208822497,0.855766841771,0.848899545719,0.838478415876,0.833371868231,0.821668577243,0.808004587539,0.795333343034,0.788581921151,0.775192256803,0.765042757568,0.74822591259,0.735501851022,0.719723561961,0.706914346354,0.69045967552,0.672747635224,0.648681917863,0.627266215781,0.599597081264,0.569249906088,0.543816873542,0.518966445536,0.490110543956,0.458497915073,0.42075257847,0.377997705153,0.336176831526,0.285607188726,0.233692866625,0.17300067207,0.116309100542,0.0589276735,0.0178349208094)
accepted_hits.6 <- c(0.0,0.0336858038111,0.0826776510307,0.143799118795,0.205539690655,0.269131263265,0.337374436337,0.40553670702,0.461682964768,0.51816258626,0.557795576303,0.591071704189,0.640469784679,0.673057381597,0.713790873637,0.739844311673,0.774044792382,0.797539764098,0.816411250366,0.838266370828,0.85631506259,0.871302660426,0.883012277081,0.903632058231,0.914338714777,0.914523470586,0.923487570008,0.930847966051,0.933635942694,0.947726728944,0.953220632289,0.959714626865,0.963054002058,0.967053219427,0.971526375613,0.981943275376,0.980473835536,0.983615258076,0.989992776163,0.993977075361,0.990656060995,0.995968651185,0.992336650331,0.992983295665,0.990372615746,0.996814396724,1.0,0.994623146919,0.994301258692,0.9899302346,0.990129334804,0.986167986638,0.984574611224,0.973434753945,0.975519281449,0.957184849335,0.954714744489,0.944757439147,0.92689407697,0.928477698195,0.922267148868,0.920760987376,0.912905422813,0.903839191297,0.890803004979,0.876487872388,0.866517943978,0.864298579159,0.853871925207,0.840309586474,0.834248792632,0.822879998807,0.80955749836,0.797018775666,0.791781923882,0.776136778972,0.766333245546,0.750454573883,0.73817003387,0.72357432491,0.709786492285,0.693136092162,0.672787706968,0.649729952417,0.627200645383,0.59971162028,0.569246420069,0.542155595376,0.51566149752,0.485127444213,0.451572461286,0.414670070305,0.372302464769,0.331292986566,0.281696953423,0.229057039627,0.168546643096,0.112626453016,0.0551536256033,0.0139438996443)
accepted_hits.7 <- c(0.0,0.0316514072838,0.0779126921065,0.13642236253,0.197560476154,0.260017945057,0.327743708535,0.395013145068,0.451143070476,0.506891962885,0.547250658679,0.581479172383,0.631044264284,0.665040051246,0.707509829568,0.732728738159,0.767248160289,0.791396411787,0.811487916748,0.833740700199,0.85095278214,0.866617915738,0.879521130504,0.898861977641,0.909834359023,0.910905586526,0.920321322618,0.929268753184,0.932996944321,0.949052237457,0.955006163266,0.962262902502,0.966860396468,0.97028398937,0.974362411437,0.985687875792,0.981392128018,0.986789905363,0.992418127816,0.995373415191,0.991592746455,0.9963465324,0.991899626325,0.993663900375,0.989628829367,0.995377408052,1.0,0.994962150532,0.995614698063,0.991747897616,0.991228825717,0.987702559253,0.984756968825,0.972180027825,0.974337313455,0.95523774919,0.952495794662,0.94277717156,0.925271899558,0.927764015084,0.921110197823,0.920348702235,0.910644909758,0.901493272885,0.888898649215,0.874245420617,0.865186760358,0.863293573947,0.85317509436,0.842375546808,0.835289930176,0.823609671621,0.809477796557,0.797462137698,0.793152129706,0.778300969295,0.768165947857,0.75146666332,0.739199454233,0.725537595921,0.713114094856,0.695642476965,0.676939917142,0.653829809444,0.630374034084,0.602586004795,0.572046894438,0.545140716969,0.518029762784,0.486515823992,0.451981571236,0.414517129087,0.370904251769,0.328809802359,0.277211203511,0.22506900519,0.164557200297,0.108756971107,0.0525500405275,0.0133732315192)
accepted_hits.9 <- c(0.0,0.0334775487045,0.081784568197,0.141532688669,0.200760911166,0.266602610597,0.333615251411,0.397741354438,0.453852196418,0.510729168618,0.550101570801,0.587949072748,0.636538456391,0.668264945896,0.707244580883,0.732753037087,0.767256999553,0.787666842419,0.809305839184,0.828337316764,0.846893057589,0.862513415643,0.87161798673,0.893445672334,0.905252776135,0.906967703429,0.917332876555,0.923871413239,0.928648854083,0.945861023309,0.948102539671,0.955266693609,0.960385380228,0.963512128276,0.965200960306,0.977436294098,0.974106805913,0.981807585559,0.98761612393,0.99196801122,0.989026606465,0.996184738418,0.995163677532,0.998900653318,0.995247985312,0.999793914317,1.0,0.995894344955,0.993769253622,0.986730892244,0.985631545562,0.982945071474,0.979609561305,0.964092915202,0.965695432124,0.946339436503,0.944409055994,0.934700279152,0.915615272823,0.919071891786,0.912360055777,0.911591918229,0.901517807677,0.89302078789,0.881591730879,0.868020185691,0.858328136584,0.85693772733,0.848254026031,0.837095289202,0.829617322974,0.815806905744,0.80091052402,0.78964807524,0.782157395933,0.768953860895,0.75884027289,0.745270065921,0.733875802597,0.72018783238,0.708157246053,0.69153991505,0.67512866973,0.653578664511,0.633838600116,0.607974846841,0.576943561964,0.551764976675,0.526716867712,0.495284786327,0.462940039772,0.422102957196,0.378835669417,0.336230799907,0.282950959637,0.230549659959,0.169339535531,0.111932628717,0.0541670792841,0.0146876196033)
accepted_hits.3 <- c(0.0,0.0321423710201,0.080070779474,0.139770082061,0.202974675806,0.267191129957,0.335483171419,0.400244544467,0.456294597644,0.51398033032,0.553567465435,0.590135629898,0.639864900717,0.675194193684,0.716972078097,0.742017122727,0.774254543106,0.798210211346,0.818990954162,0.839244311457,0.85656590358,0.87207002277,0.88266387363,0.900435796696,0.909385201369,0.911482285522,0.922667195744,0.929483065296,0.931189801112,0.946388009016,0.950130462166,0.958120606563,0.959891477625,0.963319252801,0.96854466051,0.978483778166,0.975802094316,0.980799106721,0.986233069333,0.990114866689,0.98734413174,0.993174902355,0.989895238073,0.990453537705,0.991265148492,0.998720524894,1.0,0.995721856046,0.995007601642,0.991976634468,0.992646594026,0.99022606521,0.986791368965,0.974191792073,0.973600732711,0.955374787465,0.951240140359,0.94281950542,0.926744167268,0.92884401985,0.920782357732,0.919480273798,0.911059177454,0.903747759304,0.890937320485,0.878220546811,0.867948756399,0.866474568529,0.857341524804,0.847004676336,0.840509483019,0.828343165098,0.816274664963,0.806154676682,0.799857425962,0.787618667509,0.779261706413,0.764137784658,0.752126037295,0.737845101844,0.724198136387,0.707603717999,0.69060372492,0.666410433282,0.644405122514,0.616909096362,0.586511757744,0.56152669572,0.537047794601,0.508861045681,0.476934150635,0.439685875711,0.396834764072,0.355091946412,0.303265130035,0.250217436943,0.187042373096,0.125264903947,0.0633711608249,0.0195367958677)
data_matrix <- matrix(c(accepted_hits.2,accepted_hits,accepted_hits.1,accepted_hits.8,accepted_hits.5,accepted_hits.11,accepted_hits.10,accepted_hits.4,accepted_hits.6,accepted_hits.7,accepted_hits.9,accepted_hits.3), byrow=T, ncol=100)
rowLabel <- c("Day Zero_R3","Day Zero_R1","Day Zero_R2","Day Six_R3","Day Three_R3","Day Twelve_R3","Day Twelve_R2","Day Three_R2","Day Six_R1","Day Six_R2","Day Twelve_R1","Day Three_R1")


pdf("output.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("output.geneBodyCoverage.curves.pdf", pointsize=15)
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(12)
layout(matrix(c(1,1,1,2,1,1,1,2,1,1,1,2), 4, 4, byrow = TRUE))
plot(x,accepted_hits.2,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=2,col=icolor[1])
lines(x,accepted_hits,type='l',lwd=2, col=icolor[2])
lines(x,accepted_hits.1,type='l',lwd=2, col=icolor[3])
lines(x,accepted_hits.8,type='l',lwd=2, col=icolor[4])
lines(x,accepted_hits.5,type='l',lwd=2, col=icolor[5])
lines(x,accepted_hits.11,type='l',lwd=2, col=icolor[6])
lines(x,accepted_hits.10,type='l',lwd=2, col=icolor[7])
lines(x,accepted_hits.4,type='l',lwd=2, col=icolor[8])
lines(x,accepted_hits.6,type='l',lwd=2, col=icolor[9])
lines(x,accepted_hits.7,type='l',lwd=2, col=icolor[10])
lines(x,accepted_hits.9,type='l',lwd=2, col=icolor[11])
lines(x,accepted_hits.3,type='l',lwd=2, col=icolor[12])
par(mar=c(1,0,2,1))
plot.new()
legend(0,1,fill=icolor[1:12],legend=c('Day Zero_R3','Day ZeroR1','Day Zero_R2','Day Six_R3','Day Three_R3','Day Twelve_R3','Day Twelve_R2','Day Three_R2','Day Six_R1','Day Six_R2','Day Twelve_R1','Day Three_R1'))
dev.off()
